
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MF3D ‘Face-space’ construction &#8212; MF3D 1.0 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/mf3d.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MF3D Research" href="MF3D-Research.html" />
    <link rel="prev" title="Overview" href="MF3D-Video-Parameter-Estimation-GUI.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="MF3D-Research.html" title="MF3D Research"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="MF3D-Video-Parameter-Estimation-GUI.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MF3D 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MF3D ‘Face-space’ construction</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mf3d-face-space-construction">
<h1>MF3D ‘Face-space’ construction<a class="headerlink" href="#mf3d-face-space-construction" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#parameterizing-anatomical-variations" id="id2">Parameterizing anatomical variations</a></p></li>
<li><p><a class="reference internal" href="#craniofacial-morphology-analysis-for-mf3d" id="id3">Craniofacial morphology analysis for MF3D</a></p></li>
<li><p><a class="reference internal" href="#sample-space-expansion" id="id4">Sample space expansion</a></p></li>
<li><p><a class="reference internal" href="#expression-transfer" id="id5">Expression transfer</a></p></li>
</ul>
</div>
<div class="section" id="parameterizing-anatomical-variations">
<h2><a class="toc-backref" href="#id2">Parameterizing anatomical variations</a><a class="headerlink" href="#parameterizing-anatomical-variations" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right" id="id1" style="width: 50%">
<a class="reference internal image-reference" href="_images/FaceSpace_DurerLeopold.png"><img alt="Parameterization of facial shape" src="_images/FaceSpace_DurerLeopold.png" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text"><strong>A.</strong> <a class="reference external" href="https://en.wikipedia.org/wiki/Albrecht_D%C3%BCrer">Dürer (1528)</a> originally proposed mathematical descriptions of variation in face shape using deformation grid. <strong>B.</strong> <a class="reference external" href="https://doi.org/10.1038/82947">Leopold et al., 2006</a> used digital 3D scans of human faces to generate visual stimuli for neuroscientific research. The ‘face-space’ construct of facial identity variation features the average face at the center of a high-dimensional parameter space, in which distance from the center corresponds to facial distinctiveness.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>One of the earliest studies of variation in anatomical proportions was
by the German Renaissance artist <a class="reference external" href="https://www.nlm.nih.gov/exhibition/historicalanatomies/durer_bio.html">Albrecht Dürer
(1528)</a>,
who described the application of <a class="reference external" href="https://www.virtual-anthropology.com/virtual-anthropology/compare/geometric-morphometrics/thin-plate-spline/">deformation
grids</a>
to mathematically describe variation in human facial anatomy. This approach was further developed by Scottish mathematical biologist D’Arcy Thompson in <a class="reference external" href="https://en.wikipedia.org/wiki/On_Growth_and_Form">On Growth and Form (1917)</a>.</p>
<p>In the digital age, a pioneering study by <a class="reference external" href="https://doi.org/10.1145/311535.311556">Blanz &amp; Vetter (1999)</a> was the first to apply this approach to 3D face data acquired through laser scans of 200 human participants. Specifically, they used <a class="reference external" href="https://en.wikipedia.org/wiki/Principal_component_analysis">principal component analysis (PCA)</a> to identify the major components of morphological variation in their sample. The resulting statistical description of ‘face space’ can be used to generate an infinite number of novel faces, which is now commercially available as the <a class="reference external" href="https://facegen.com/">FaceGen</a> software.</p>
</div>
<div class="section" id="craniofacial-morphology-analysis-for-mf3d">
<h2><a class="toc-backref" href="#id3">Craniofacial morphology analysis for MF3D</a><a class="headerlink" href="#craniofacial-morphology-analysis-for-mf3d" title="Permalink to this headline">¶</a></h2>
<p>The method for creating the macaque face-space used to generate identity
variations in MF3D is described in <a class="reference external" href="https://doi.org/10.1016/j.jneumeth.2019.06.001">Murphy &amp; Leopold
(2019)</a> and
illustrated in figure 5 from that paper (below). Briefly, Corresponding vertices
were manually selected on a low polygon count (50,000 vertices) base mesh topology
(created based on individual M02 of the CT data sample) and the high poly raw
surface meshes of each other individual (panel A). This was performed in the
commercial software <a class="reference external" href="https://www.russian3dscanner.com/">Wrap3</a>, which then applies
a warping process to produces a surface mesh with topology A and
morphology B (bottom left of panel A). This process was repeated for each individual in the sample, and the resulting mesh data were then manually cleaned by a professional digital artist (bottom right of panel A).</p>
<p>The cleaned corresponding meshes of all individuals were then imported into
Matlab, their vertex positions were averaged to generate the mesh of
the sample mean and a PCA was run.</p>
<div class="figure align-default">
<img alt="Facial morphology analysis" src="_images/MurphyLeopold_Fig5.jpg" />
</div>
<p><strong>Fig. 5. Morphable face model construction.</strong>
<strong>A.</strong> Example of manual selection of corresponding vertices on the low-poly base mesh topology (topology A) created from individual M02 (morphology A) and the high-poly raw surface mesh of individual M09 (right). The warping process produces a surface mesh with topology A and morphology B (bottom left), which can then be manually edited (bottom right).
<strong>B.</strong> Sample mean mesh surface.
<strong>C.</strong> First five principal components (mean ± 2σ) of macaque face-space.
<strong>D.</strong> Locations of original sample identities (n
= 23) projected into principal component face-space (first 3 PC dimensions only).
<strong>E.</strong> Distribution of CT scan voxel volume for each
individual plotted against their Euclidean distance from the sample mean
(σ).
<strong>F.</strong> Percentage of variance in sample cranio-facial morphology
explained by each principal component.
<strong>G.</strong> Distributions of demographic variables for Rhesus macaque CT data sample.
<strong>H.</strong> Age trajectory through face-space for males calculated by averaging 5
youngest (2nd column) and 5 oldest (4th column) males, and
extrapolating.
<strong>I.</strong> Sexual dimorphism trajectory through face-space
calculated by averaging 5 males (2nd column) and 5 females (4th column),
and extrapolating. Colour map indicates the displacement of each vertex
relative to the mean (middle column) for each mesh. Meshes were aligned
via Procrustes method.</p>
</div>
<div class="section" id="sample-space-expansion">
<h2><a class="toc-backref" href="#id4">Sample space expansion</a><a class="headerlink" href="#sample-space-expansion" title="Permalink to this headline">¶</a></h2>
<div class="figure align-right">
<a class="reference internal image-reference" href="_images/PlotDemo_UNC.png"><img alt="_images/PlotDemo_UNC.png" src="_images/PlotDemo_UNC.png" style="width: 300px;" /></a>
</div>
<p>The validity of a ‘face-space’ is fundamentally limited by the sample used to construct it. The demographic make-up of the sample used to construct the original MF3D face-space is shown in Figure 5G above. All animals in this sample (N = 36) were over 4 years of age, and only a small proportion were female (N = 7). Although it is possible to identify an axis within the N-dimensional face-space that corresponds to age and then linearly extrapolate (Figure 5H), the resulting constructions of facial morphology are unlikely to be realistic (e.g. due to non-linear age related changes in facial morphology).</p>
<p>To resolve this issue, we expanded the sample used to construct the face-space model, using the <a class="reference external" href="https://data.kitware.com/#collection/54b582c38d777f4362aa9cb3">UNC-Wisconsin Rhesus macaque Neurodevelopment Database</a> (<a class="reference external" href="https://doi.org/10.3389/fnins.2017.00029">Young et al., 2017</a>). This database includes anatomical (T1-weighted) MRI scans from 36 infant Rhesus macaques between the ages of 2 weeks to 4 years old, collected longitudinally (150 scans total). The demographic distribution of this additional sample is shown in the plot on the right. The figure below illustrates raw soft tissue surface reconstructions from the T1 data for an individual at 5 time points during the first year of life. The segmentation of soft tissue from MRI data is noticeably noisier than segmentations from CT data, requires more smoothing and therefore lacks comparable detail. However, the data are sufficient to estimate craniofacial morphology since we fit the existing base mesh (clean topology) constructed from CT data to these raw MRI-derived meshes.</p>
<a class="reference internal image-reference" href="_images/UNC_Summary_Fig1.png"><img alt="Craniofacial development in Rhesus macaque" class="align-left" src="_images/UNC_Summary_Fig1.png" style="width: 60%;" /></a>
<div class="clearer docutils container">
<a class="reference internal image-reference" href="_images/spacer.png"><img alt="_images/spacer.png" src="_images/spacer.png" style="height: 1px;" /></a>
</div>
</div>
<div class="section" id="expression-transfer">
<h2><a class="toc-backref" href="#id5">Expression transfer</a><a class="headerlink" href="#expression-transfer" title="Permalink to this headline">¶</a></h2>
<p>Another limitation of the original MF3D model was that identity was parameterized separately from expression, and it was therefore not possible to generate faces of different individuals with the various modeled expressions. To resolve this issue we performed expression cloning, transferring the expression component of the original model into the face-space framework. This was achieved using <a class="reference external" href="https://www.russian3dscanner.com/">Wrap3 (RS3D)</a> software.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/MF3D_Logo_black.svg" alt="Logo"/>
            </a></p>
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="MF3D-Overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Release-1.html">MF3D Release 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Release-2.html">MF3D Release 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Stimulus-Editor.html">MF3D Tools - Stimulus Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Video-Parameter-Estimation-GUI.html">MF3D Tools - Video Parameter GUI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Methods - Face Space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameterizing-anatomical-variations">Parameterizing anatomical variations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#craniofacial-morphology-analysis-for-mf3d">Craniofacial morphology analysis for MF3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sample-space-expansion">Sample space expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expression-transfer">Expression transfer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MF3D-Research.html">Published Research</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="MF3D-Video-Parameter-Estimation-GUI.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="MF3D-Research.html"
                        title="next chapter">MF3D Research</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="MF3D-Research.html" title="MF3D Research"
             >next</a> |</li>
        <li class="right" >
          <a href="MF3D-Video-Parameter-Estimation-GUI.html" title="Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MF3D 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">MF3D ‘Face-space’ construction</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Aidan Murphy.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>